define(["equation-about-template","lang-json"],function(e,t){var n=Backbone.View.extend({initialize:function(e){this.listenTo(this.model,"OnPopupVisibilityChange",this.OnPopupVisibilityChange),this.accManager=e.accManager,this.bIsVisible=!1,this.bIsPopupAlreadyOpen=!1,this.langJson=t.aboutpopupJSON,this.accJson=t.aboutpopupAccJSON,this.versionAccText="",this.licenseAccText="",this.creditAccText="",this.acknowledgementsAccText="",this.render()},render:function(){var e=Handlebars.templates["equation-about-template"]({}).trim()
this.$el.append(e),this.$("#plg-about-popup-label-exp").html(this.langJson.title),this.$("#plg-eqn-popup-version-tab").html(this.langJson.version.version_title),this.$("#plg-eqn-popup-version-line-one").html(this.langJson.version.line_one),this.$("#plg-eqn-popup-version-line-two").html(this.langJson.version.line_two),this.$("#plg-eqn-popup-version-line-three").html(this.langJson.version.line_three),this.$("#plg-eqn-popup-version-line-four").html(this.langJson.version.line_four),this.$("#plg-eqn-popup-license-tab").html(this.langJson.license.license_title),this.$("#plg-eqn-popup-license-line-one").html(this.langJson.license.line_one),this.$("#plg-eqn-popup-license-line-two").html(this.langJson.license.line_two),this.$("#plg-eqn-popup-license-line-three").html(this.langJson.license.line_three),this.$("#plg-eqn-popup-license-line-four").html(this.langJson.license.line_four),this.$("#plg-eqn-popup-license-line-five").html(this.langJson.license.line_five),this.$("#plg-eqn-popup-license-line-six").html(this.langJson.license.line_six),this.$("#plg-eqn-popup-credits-tab").html(this.langJson.credits.credits_title),this.$("#plg-eqn-popup-credits-line-one").html(this.langJson.credits.line_one),this.$("#plg-eqn-popup-credits-line-two").html(this.langJson.credits.line_two),this.$("#plg-eqn-popup-credits-line-three").html(this.langJson.credits.line_three),this.$("#plg-eqn-popup-credits-line-four").html(this.langJson.credits.line_four),this.$("#plg-eqn-popup-credits-line-five").html(this.langJson.credits.line_five),this.$("#plg-eqn-popup-credits-line-six").html(this.langJson.credits.line_six),this.$("#plg-eqn-popup-credits-line-seven").html(this.langJson.credits.line_seven),this.$("#plg-eqn-popup-credits-line-eight").html(this.langJson.credits.line_eight),this.$("#plg-eqn-popup-acknowledgements-tab").html(this.langJson.acknowledgements.acknowledgements_title),this.$("#plg-eqn-popup-acknowledgements-line-one").html(this.langJson.acknowledgements.para_one),this.$("#plg-eqn-popup-acknowledgements-line-two").html(this.langJson.acknowledgements.para_two),this.$("#plg-eqn-popup-acknowledgements-line-three").html(this.langJson.acknowledgements.para_three),this.$("#plg-eqn-popup-version-tab").addClass("selectedTab"),this._attachEvents(),this.showAboutPage(!1)},events:{"keyup #plg-equation-about-panel":"popupHolderKeyup","click .tab":"popupTabClick"},popupHolderKeyup:function(e){if(null!=this.accManager&&this.accManager.isAccessibilityOn){var t=e.keyCode||e.which
27===t&&this.showAboutPage(!1)}},_attachEvents:function(){var e=this
this.$(".plg-about-popup-close").on("click",function(){e.showAboutPage(!1)})},showAboutPage:function(e){e?(this.$(".plg-equation-about-panel").show(),this.$("#plg-eqn-popup-version-tab-radio").attr("checked","checked"),this.showClickedTab("plg-eqn-popup-version-tab")):this.$(".plg-equation-about-panel").hide(),this.bIsVisible=e,this.model.PopupVisibilityChange({bIsVisible:e,popupName:"About Popup",affectedExpData:null})},popupTabClick:function(e){this.showClickedTab(e.currentTarget.id)},showClickedTab:function(e){this.$(".tab").removeClass("selectedTab"),this.$(".plg-eqn-popup-content-holder .content").hide(),this.$("."+e).addClass("selectedTab"),this.$("."+e.split("-tab")[0]+".content").show().scrollTop(0),null!=this.accManager&&this.accManager.isAccessibilityOn&&(this.setAboutPageAccText(e),this.disableTabAllContent(),this.accManager.enableTab(this.$("#"+e.split("-tab")[0]+"-content"),!0))},disableTabAllContent:function(){var e=this.$("#plg-eqn-popup-version-content"),t=this.$("#plg-eqn-popup-license-content"),n=this.$("#plg-eqn-popup-credits-content"),i=this.$("#plg-eqn-popup-acknowledgements-content")
this.accManager.enableTab(e,!1),this.accManager.enableTab(t,!1),this.accManager.enableTab(n,!1),this.accManager.enableTab(i,!1)},setAboutPageAccText:function(e){var t="Press spacebar followed by tab to reveal the content",n=this.$("#plg-eqn-popup-version-tab"),i=this.$("#plg-eqn-popup-license-tab"),s=this.$("#plg-eqn-popup-credits-tab"),l=this.$("#plg-eqn-popup-acknowledgements-tab"),c=[t]
this.accManager.setAccText(n,this.versionAccText,c),this.accManager.setAccText(i,this.licenseAccText,c),this.accManager.setAccText(s,this.creditAccText,c),this.accManager.setAccText(l,this.acknowledgementsAccText,c),"plg-eqn-popup-version-tab"===e?this.accManager.setAccText(this.$("#"+e),this.versionAccText,[""]):"plg-eqn-popup-license-tab"===e?this.accManager.setAccText(this.$("#"+e),this.licenseAccText,[""]):"plg-eqn-popup-credits-tab"===e?this.accManager.setAccText(this.$("#"+e),this.creditAccText,[""]):"plg-eqn-popup-acknowledgements-tab"===e&&this.accManager.setAccText(this.$("#"+e),this.acknowledgementsAccText,[""])},OnPopupVisibilityChange:function(e){null!=this.accManager&&this.accManager.isAccessibilityOn&&(e.bIsVisible?(this.setAccOn(),this.$("#plg-about-popup-holder").focus()):(this.setAccOff(),this.bIsPopupAlreadyOpen=!1))},setAccOn:function(){for(var e,t=this.accJson.length,n=0;t>n;n++){e=this.accJson[n]
var i=null
"#plg-eqn-popup-version-tab"===e.id?this.versionAccText=e.accText:"#plg-eqn-popup-license-tab"===e.id?this.licenseAccText=e.accText:"#plg-eqn-popup-credits-tab"===e.id?this.creditAccText=e.accText:"#plg-eqn-popup-acknowledgements-tab"===e.id&&(this.acknowledgementsAccText=e.accText),this.accManager.setTabIndex(this.$(e.id),e.tabIndex),this.accManager.setAccText(this.$(e.id),e.accText,i)}this.$("#plg-eqn-popup-version-tab").addClass("selectedTab"),this.setAboutPageAccText("plg-eqn-popup-version-tab")},setAccOff:function(){for(var e,t=this.accJson.length,n=0;t>n;n++)e=this.accJson[n],this.accManager.setTabIndex(this.$(e.id),-1),this.accManager.setAccText(this.$(e.id),"",null)
this.$(".acc-element").on("keydown",_.bind(this.accManager._keyPressHandler,this))}})
return n})
