define(["equation-axis-label-template","lang-json"],function(e,t){var i=Backbone.View.extend({initialize:function(e){this.accManager=e.accManager,this.bIsVisible=!1,this.bIsPopupAlreadyOpen=!1,this.langJson=t.axislabelpopupJSON,this.accJson=t.axislabelpopupAccJSON,this.listenTo(this.model,"OnPopupVisibilityChange",this.OnPopupVisibilityChange),this.xAxisLabelAccText="",this.yAxisLabelAccText="",this.render()},render:function(){var e=Handlebars.templates["equation-axis-label-template"]({}).trim()
this.$el.append(e),this.$(".plg-axis-popup-label").html(this.langJson.title),this.$(".plg-axis-label").html(this.langJson.line_one),this.$(".plg-x-axis-text").html(this.langJson.line_two),this.$(".plg-y-axis-text").html(this.langJson.line_three),this.$("#plg-axis-ok-btn").html(this.langJson.btn_ok),this._attachEvents(),this.showAxisLabelPopup(!1)},events:{"click #plg-axis-ok-btn":"showOk","keyup #plg-equation-axis-label-panel":"popupHolderKeyup","focusout #plg-x-axis-input-text":"changeXInputText","focusout #plg-y-axis-input-text":"changeYInputText"},popupHolderKeyup:function(e){if(null!=this.accManager&&this.accManager.isAccessibilityOn){var t=e.keyCode||e.which
27===t&&this.showAxisLabelPopup(!1)}},showOk:function(){},changeXInputText:function(){var e=this.$("#plg-x-axis-input-text").val()
if(null!=this.accManager&&this.accManager.isAccessibilityOn){var t="Currently there is no x axis label. Use the keyboard to type an x axis label.",i=""
""!==e&&(t="Currently the x axis label is "+e+". Use the keyboard to edit the x axis label."),i=[t],this.accManager.setAccText(this.$("#plg-x-axis-input-text"),this.xAxisLabelAccText,i)}},changeYInputText:function(){var e=this.$("#plg-y-axis-input-text").val()
if(null!=this.accManager&&this.accManager.isAccessibilityOn){var t="Currently there is no y axis label. Use the keyboard to type an y axis label.",i=""
""!==e&&(t="Currently the y axis label is "+e+". Use the keyboard to edit the y axis label."),i=[t],this.accManager.setAccText(this.$("#plg-y-axis-input-text"),this.yAxisLabelAccText,i)}},_attachEvents:function(){var e=this
this.$(".plg-axis-popup-close").on("click",function(){e.showAxisLabelPopup(!1)}),this.$(".plg-axis-ok-btn").on("click",function(){e.model.xAxisLabel=e.$(".plg-x-axis-input-text").val(),e.model.yAxisLabel=e.$(".plg-y-axis-input-text").val(),e.model.AxesLabelChange(),e.showAxisLabelPopup(!1)})},showAxisLabelPopup:function(e){e?(this.$(".plg-equation-axis-label-panel").show(),this.$(".plg-x-axis-input-text").val(this.model.xAxisLabel),this.$(".plg-y-axis-input-text").val(this.model.yAxisLabel)):this.$(".plg-equation-axis-label-panel").hide(),this.bIsVisible=e,this.model.PopupVisibilityChange({bIsVisible:e,popupName:"Axis Label Popup",affectedExpData:null})},OnPopupVisibilityChange:function(e){this.bIsPopupAlreadyOpen=e.bIsVisible,null!=this.accManager&&this.accManager.isAccessibilityOn&&(e.bIsVisible?(this.setAccOn(),this.$("#plg-axis-popup-holder").focus()):this.setAccOff())},setAccOn:function(){for(var e,t=this.accJson.length,i=0;t>i;i++){e=this.accJson[i],this.accManager.setTabIndex(this.$(e.id),e.tabIndex)
var s=null
if("#plg-x-axis-input-text"===e.id){this.xAxisLabelAccText=e.accText
var a="Currently there is no x axis label. Use the keyboard to type an x axis label."
""!==this.model.xAxisLabel&&(a="Currently the x axis label is "+this.model.xAxisLabel+". Use the keyboard to edit the x axis label."),s=[a]}else if("#plg-y-axis-input-text"===e.id){this.yAxisLabelAccText=e.accText
var l="Currently there is no y axis label. Use the keyboard to type a y axis label."
""!==this.model.yAxisLabel&&(l="Currently the y axis label is "+this.model.yAxisLabel+". Use the keyboard to edit the y axis label."),s=[l]}this.accManager.setAccText(this.$(e.id),e.accText,s)}},setAccOff:function(){for(var e,t=this.accJson.length,i=0;t>i;i++)e=this.accJson[i],this.accManager.setTabIndex(this.$(e.id),-1),this.accManager.setAccText(this.$(e.id),"",null)
this.$(".acc-element").on("keydown",_.bind(this.accManager._keyPressHandler,this))}})
return i})
